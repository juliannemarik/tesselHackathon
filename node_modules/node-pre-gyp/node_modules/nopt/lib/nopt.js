function e(e,t,a){a=a||exports.typeDefs;var i={},l=[!1,!0,null,String,Array];Object.keys(e).forEach(function(o){if("argv"!==o){var s=e[o],u=Array.isArray(s),f=t[o];u||(s=[s]),f||(f=l),f===Array&&(f=l.concat(Array)),Array.isArray(f)||(f=[f]),n("val=%j",s),n("types=",f),(s=s.map(function(l){if("string"==typeof l&&(n("string %j",l),"null"===(l=l.trim())&&~f.indexOf(null)||"true"===l&&(~f.indexOf(!0)||~f.indexOf(Boolean))||"false"===l&&(~f.indexOf(!1)||~f.indexOf(Boolean))?(l=JSON.parse(l),n("jsonable %j",l)):~f.indexOf(Number)&&!isNaN(l)?(n("convert to number",l),l=+l):~f.indexOf(Date)&&!isNaN(Date.parse(l))&&(n("convert to date",l),l=new Date(l))),!t.hasOwnProperty(o))return l;!1!==l||!~f.indexOf(null)||~f.indexOf(!1)||~f.indexOf(Boolean)||(l=null);var s={};return s[o]=l,n("prevalidated val",s,l,t[o]),r(s,o,l,t[o],a)?(n("validated val",s,l,t[o]),s[o]):(exports.invalidHandler?exports.invalidHandler(o,l,t[o],e):!1!==exports.invalidHandler&&n("invalid: "+o+"="+l,t[o]),i)}).filter(function(e){return e!==i})).length?u?(n(u,e[o],s),e[o]=s):e[o]=s[0]:delete e[o],n("k=%s val=%j",o,s,e[o])}})}function r(e,t,a,i,l){var o,s,u,f,p,c;if(Array.isArray(i)){for(o=0,s=i.length;o<s;o++)if(i[o]!==Array&&r(e,t,a,i[o],l))return!0;return delete e[t],!1}if(i===Array)return!0;if(i!=i)return n("Poison NaN",t,a,i),delete e[t],!1;if(a===i)return n("Explicitly allowed %j",a),e[t]=a,!0;for(u=!1,o=0,s=(f=Object.keys(l)).length;o<s;o++)if(n("test type %j %j %j",t,a,f[o]),(p=l[f[o]])&&(i&&i.name&&p.type&&p.type.name?i.name===p.type.name:i===p.type)&&(c={},u=!1!==p.validate(c,t,a),a=c[t],u)){e[t]=a;break}return n("OK? %j (%j %j %j)",u,t,a,f[o]),u||delete e[t],u}var n=process.env.DEBUG_NOPT||process.env.NOPT_DEBUG?function(){console.error.apply(console,arguments)}:function(){},t=require("url"),a=require("path"),i=require("stream").Stream,l=require("abbrev"),o=require("osenv");module.exports=exports=function(r,t,a,i){a=a||process.argv,r=r||{},t=t||{},"number"!=typeof i&&(i=2),n(r,t,a,i);var o={},s={remain:[],cooked:a=a.slice(i),original:a.slice(0)};return function(e,r,t,a,i){var o,s,u,f,p,c,d,y,v,O,h,m,j,x;for(n("parse",e,r,t),o=l(Object.keys(a)),s=l(Object.keys(i)),u=0;u<e.length;u++){if(f=e[u],n("arg",f),f.match(/^-{2,}$/)){t.push.apply(t,e.slice(u+1)),e[u]="--";break}if(p=!1,"-"===f.charAt(0)&&f.length>1){if((c=f.indexOf("="))>-1&&(p=!0,d=f.substr(c+1),f=f.substr(0,c),e.splice(u,1,f,d)),y=function(e,r,t,a){var i,l;return e=e.replace(/^-+/,""),a[e]===e?null:r[e]?(r[e]&&!Array.isArray(r[e])&&(r[e]=r[e].split(/\s+/)),r[e]):((i=r.___singles)||(i=Object.keys(r).filter(function(e){return 1===e.length}).reduce(function(e,r){return e[r]=!0,e},{}),r.___singles=i,n("shorthand singles",i)),(l=e.split("").filter(function(e){return i[e]})).join("")===e?l.map(function(e){return r[e]}).reduce(function(e,r){return e.concat(r)},[]):a[e]&&!r[e]?null:(t[e]&&(e=t[e]),r[e]&&!Array.isArray(r[e])&&(r[e]=r[e].split(/\s+/)),r[e]))}(f,i,s,o),n("arg=%j shRes=%j",f,y),y&&(n(f,y),e.splice.apply(e,[u,1].concat(y)),f!==y[0])){u--;continue}for(f=f.replace(/^-+/,""),v=null;0===f.toLowerCase().indexOf("no-");)v=!v,f=f.substr(3);if(o[f]&&(f=o[f]),O=a[f],(h=Array.isArray(O))&&1===O.length&&(h=!1,O=O[0]),m=O===Array||h&&-1!==O.indexOf(Array),!a.hasOwnProperty(f)&&r.hasOwnProperty(f)&&(Array.isArray(r[f])||(r[f]=[r[f]]),m=!0),x=e[u+1],"boolean"==typeof v||O===Boolean||h&&-1!==O.indexOf(Boolean)||void 0===O&&!p||"false"===x&&(null===O||h&&~O.indexOf(null))){j=!v,"true"!==x&&"false"!==x||(j=JSON.parse(x),x=null,v&&(j=!j),u++),h&&x&&(~O.indexOf(x)?(j=x,u++):"null"===x&&~O.indexOf(null)?(j=null,u++):x.match(/^-{2,}[^-]/)||isNaN(x)||!~O.indexOf(Number)?!x.match(/^-[^-]/)&&~O.indexOf(String)&&(j=x,u++):(j=+x,u++)),m?(r[f]=r[f]||[]).push(j):r[f]=j;continue}O===String&&(void 0===x?x="":x.match(/^-{1,2}[^-]+/)&&(x="",u--)),x&&x.match(/^-{2,}$/)&&(x=void 0,u--),j=void 0===x||x,m?(r[f]=r[f]||[]).push(j):r[f]=j,u++}else t.push(f)}}(a,o,s.remain,r,t),e(o,r,exports.typeDefs),o.argv=s,Object.defineProperty(o.argv,"toString",{value:function(){return this.original.map(JSON.stringify).join(" ")},enumerable:!1}),o},exports.clean=e,exports.typeDefs={String:{type:String,validate:function(e,r,n){e[r]=n+""}},Boolean:{type:Boolean,validate:function(e,r,n){n=n instanceof Boolean?n.valueOf():"string"==typeof n?isNaN(n)?"null"!==n&&"false"!==n:!!+n:!!n,e[r]=n}},url:{type:t,validate:function(e,r,n){if(!(n=t.parse(n+"")).host)return!1;e[r]=n.href}},Number:{type:Number,validate:function(e,r,t){if(n("validate Number %j %j %j",r,t,isNaN(t)),isNaN(t))return!1;e[r]=+t}},path:{type:a,validate:function(e,r,n){if(!0===n)return!1;if(null===n)return!0;n+="";var t="win32"===process.platform?/^~(\/|\\)/:/^~\//,i=o.home();return i&&n.match(t)?e[r]=a.resolve(i,n.substr(2)):e[r]=a.resolve(n),!0}},Stream:{type:i,validate:function(e,r,n){if(!(n instanceof i))return!1;e[r]=n}},Date:{type:Date,validate:function(e,r,t){var a=Date.parse(t);if(n("validate Date %j %j %j",r,t,a),isNaN(a))return!1;e[r]=new Date(t)}}};