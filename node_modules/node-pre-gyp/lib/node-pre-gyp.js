"use strict";function e(){var e=this;this.commands={},l.forEach(function(s){e.commands[s]=function(i,n){return r.verbose("command",s,i),require("./"+s)(e,i,n)}})}var s,i,n,r,t,o,a,l,g,p;module.exports=exports,s=require("fs"),i=require("path"),n=require("nopt"),(r=require("npmlog")).disableProgress(),t=require("./util/napi.js"),o=require("events").EventEmitter,a=require("util").inherits,l=["clean","install","reinstall","build","rebuild","package","testpackage","publish","unpublish","info","testbinary","reveal","configure"],g={},r.heading="node-pre-gyp",exports.find=require("./pre-binding").find,a(e,o),exports.Run=e,(p=e.prototype).package=require("../package.json"),p.configDefs={help:Boolean,arch:String,debug:Boolean,directory:String,proxy:String,loglevel:String},p.shorthands={release:"--no-debug",C:"--directory",debug:"--debug",j:"--jobs",silent:"--loglevel=silent",silly:"--loglevel=silly",verbose:"--loglevel=verbose"},p.aliases=g,p.parseArgv=function(e){var o,a,l;this.opts=n(this.configDefs,this.shorthands,e),this.argv=this.opts.argv.remain.slice(),o=this.todo=[],(e=this.argv.map(function(e){return e in this.aliases&&(e=this.aliases[e]),e},this)).slice().forEach(function(s){if(s in this.commands){var i=e.splice(0,e.indexOf(s));e.shift(),o.length>0&&(o[o.length-1].args=i),o.push({name:s,args:[]})}},this),o.length>0&&(o[o.length-1].args=e.splice(0)),null==(a=this.opts.directory)&&(a=process.cwd()),l=JSON.parse(s.readFileSync(i.join(a,"package.json"))),this.todo=t.expand_commands(l,o),Object.keys(process.env).forEach(function(e){if(0===e.indexOf("npm_config_")){var s=process.env[e];"npm_config_loglevel"===e?r.level=s:"argv"===(e=e.substring(11))?this.opts.argv&&this.opts.argv.remain&&this.opts.argv.remain.length||(this.opts[e]=s):this.opts[e]=s}},this),this.opts.loglevel&&(r.level=this.opts.loglevel),r.resume()},p.usage=function(){return["\n  Usage: node-pre-gyp <command> [options]\n\n  where <command> is one of:",l.map(function(e){return"    - "+e+" - "+require("./"+e).usage}).join("\n"),"","node-pre-gyp@"+this.version+"  "+i.resolve(__dirname,".."),"node@"+process.versions.node].join("\n")},Object.defineProperty(p,"version",{get:function(){return this.package.version},enumerable:!0});