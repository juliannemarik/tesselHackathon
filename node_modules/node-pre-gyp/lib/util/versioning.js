"use strict";function e(e,r){if(!e)throw Error("get_electron_abi requires valid runtime arg");if(void 0===r)throw Error("Empty target version is not supported if electron is the target.");var o=p.parse(r);return e+"-v"+o.major+"."+o.minor}function r(e,r){if(!e)throw Error("get_node_webkit_abi requires valid runtime arg");if(void 0===r)throw Error("Empty target version is not supported if node-webkit is the target.");return e+"-v"+r}function o(e,r){if(!e)throw Error("get_node_abi requires valid runtime arg");if(!r)throw Error("get_node_abi requires valid process.versions object");var o=p.parse(r.node);return 0===o.major&&o.minor%2?e+"-v"+r.node:r.modules?e+"-v"+ +r.modules:"v8-"+r.v8.split(".").slice(0,2).join(".")}function t(t,n){var a,i,s,l,p,u,c,d;if(!t)throw Error("get_runtime_abi requires valid runtime arg");if("node-webkit"===t)return r(t,n||process.versions["node-webkit"]);if("electron"===t)return e(t,n||process.versions.electron);if("node"!=t)throw Error("Unknown Runtime: '"+t+"'");if(n){if(m[n])a=m[n];else{if(3!=(i=n.split(".").map(function(e){return+e})).length)throw Error("Unknown target version: "+n);if(s=i[0],l=i[1],p=i[2],1===s)for(;;){if(l>0&&--l,p>0&&--p,u=s+"."+l+"."+p,m[u]){a=m[u],console.log("Warning: node-pre-gyp could not find exact match for "+n),console.log("Warning: but node-pre-gyp successfully choose "+u+" as ABI compatible target");break}if(0===l&&0===p)break}else if(s>=2)_[s]&&(a=m[_[s]],console.log("Warning: node-pre-gyp could not find exact match for "+n),console.log("Warning: but node-pre-gyp successfully choose "+_[s]+" as ABI compatible target"));else if(0===s&&i[1]%2==0)for(;--p>0;)if(c=s+"."+l+"."+p,m[c]){a=m[c],console.log("Warning: node-pre-gyp could not find exact match for "+n),console.log("Warning: but node-pre-gyp successfully choose "+c+" as ABI compatible target");break}}if(!a)throw Error("Unsupported target version: "+n);return d={node:n,v8:a.v8+".0",modules:a.node_abi>1?a.node_abi:void 0},o(t,d)}return o(t,process.versions)}function n(e){var r,o,t=e.name+" package.json is not node-pre-gyp ready:\n",n=[];if(e.main||n.push("main"),e.version||n.push("version"),e.name||n.push("name"),e.binary||n.push("binary"),r=e.binary,g.forEach(function(e){n.indexOf("binary")>-1&&n.pop("binary"),r&&void 0!==r[e]&&""!==r[e]||n.push("binary."+e)}),n.length>=1)throw Error(t+"package.json must declare these properties: \n"+n.join("\n"));if(r&&"http:"===(o=u.parse(r.host).protocol))throw Error("'host' protocol ("+o+") is invalid - only 'https:' is accepted");d.validate_package_json(e)}function a(e,r){return Object.keys(r).forEach(function(o){for(var t="{"+o+"}";e.indexOf(t)>-1;)e=e.replace(t,r[o])}),e}function i(e){return"/"!=e.slice(-1)?e+"/":e}function s(e){var r="node";return e["node-webkit"]?r="node-webkit":e.electron&&(r="electron"),r}var l,p,u,c,d,m,_,g;module.exports=exports,l=require("path"),p=require("semver"),u=require("url"),c=require("detect-libc"),d=require("./napi.js"),m=process.env.NODE_PRE_GYP_ABI_CROSSWALK?require(process.env.NODE_PRE_GYP_ABI_CROSSWALK):require("./abi_crosswalk.json"),_={},Object.keys(m).forEach(function(e){var r=e.split(".")[0];_[r]||(_[r]=e)}),module.exports.get_electron_abi=e,module.exports.get_node_webkit_abi=r,module.exports.get_node_abi=o,module.exports.get_runtime_abi=t,g=["module_name","module_path","host"],module.exports.validate_config=n,module.exports.get_process_runtime=s,module.exports.evaluate=function(e,r,o){var m,_,g,h,f,b;return r=r||{},n(e),m=e.version,_=p.parse(m),g=r.runtime||s(process.versions),h={name:e.name,configuration:r.debug?"Debug":"Release",debug:r.debug,module_name:e.binary.module_name,version:_.version,prerelease:_.prerelease.length?_.prerelease.join("."):"",build:_.build.length?_.build.join("."):"",major:_.major,minor:_.minor,patch:_.patch,runtime:g,node_abi:t(g,r.target),node_abi_napi:d.get_napi_version()?"napi":t(g,r.target),napi_version:d.get_napi_version(),napi_build_version:o,target:r.target||"",platform:r.target_platform||process.platform,target_platform:r.target_platform||process.platform,arch:r.target_arch||process.arch,target_arch:r.target_arch||process.arch,libc:r.target_libc||c.family||"unknown",module_main:e.main,toolset:r.toolset||""},f=process.env["npm_config_"+h.module_name+"_binary_host_mirror"]||e.binary.host,h.host=i(a(f,h)),h.module_path=a(e.binary.module_path,h),r.module_root?h.module_path=l.join(r.module_root,h.module_path):h.module_path=l.resolve(h.module_path),h.module=l.join(h.module_path,h.module_name+".node"),h.remote_path=e.binary.remote_path?i(a(e.binary.remote_path,h)).replace(/\/\//g,"/"):"",b=e.binary.package_name?e.binary.package_name:"{module_name}-v{version}-{node_abi}-{platform}-{arch}.tar.gz",h.package_name=a(b,h),h.staged_tarball=l.join("build/stage",h.remote_path,h.package_name),h.hosted_path=u.resolve(h.host,h.remote_path),h.hosted_tarball=u.resolve(h.hosted_path,h.package_name),h};