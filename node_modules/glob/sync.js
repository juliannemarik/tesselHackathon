function t(t,i){if("function"==typeof i||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new r(t,i).found}function r(t,i){if(!t)throw new Error("must provide pattern");if("function"==typeof i||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof r))return new r(t,i);if(n(this,t,i),this.noprocess)return this;var s=this.minimatch.set.length;this.matches=new Array(s);for(var e=0;e<s;e++)this._process(this.minimatch.set[e],e,!1);this._finish()}module.exports=t,t.GlobSync=r;var i=require("fs"),s=require("fs.realpath"),e=require("minimatch"),a=(e.Minimatch,require("./glob.js").Glob,require("util"),require("path")),h=require("assert"),c=require("path-is-absolute"),o=require("./common.js"),n=(o.alphasort,o.alphasorti,o.setopts),l=o.ownProp,f=o.childrenIgnored,u=o.isIgnored;r.prototype._finish=function(){if(h(this instanceof r),this.realpath){var t=this;this.matches.forEach(function(r,i){var e=t.matches[i]=Object.create(null);for(var a in r)try{a=t._makeAbs(a);var h=s.realpathSync(a,t.realpathCache);e[h]=!0}catch(r){if("stat"!==r.syscall)throw r;e[t._makeAbs(a)]=!0}})}o.finish(this)},r.prototype._process=function(t,i,s){h(this instanceof r);for(var a=0;"string"==typeof t[a];)a++;var o;switch(a){case t.length:return void this._processSimple(t.join("/"),i);case 0:o=null;break;default:o=t.slice(0,a).join("/")}var n,l=t.slice(a);null===o?n=".":c(o)||c(t.join("/"))?(o&&c(o)||(o="/"+o),n=o):n=o;var u=this._makeAbs(n);f(this,n)||(l[0]===e.GLOBSTAR?this._processGlobStar(o,n,u,l,i,s):this._processReaddir(o,n,u,l,i,s))},r.prototype._processReaddir=function(t,r,i,s,e,h){var c=this._readdir(i,h);if(c){for(var o=s[0],n=!!this.minimatch.negate,l=o._glob,f=this.dot||"."===l.charAt(0),u=[],p=0;p<c.length;p++)("."!==(y=c[p]).charAt(0)||f)&&(n&&!t?!y.match(o):y.match(o))&&u.push(y);var d=u.length;if(0!==d)if(1!==s.length||this.mark||this.stat)for(s.shift(),p=0;p<d;p++){var m,y=u[p];m=t?[t,y]:[y],this._process(m.concat(s),e,h)}else for(this.matches[e]||(this.matches[e]=Object.create(null)),p=0;p<d;p++)y=u[p],t&&(y="/"!==t.slice(-1)?t+"/"+y:t+y),"/"!==y.charAt(0)||this.nomount||(y=a.join(this.root,y)),this._emitMatch(e,y)}},r.prototype._emitMatch=function(t,r){if(!u(this,r)){var i=this._makeAbs(r);if(this.mark&&(r=this._mark(r)),this.absolute&&(r=i),!this.matches[t][r]){if(this.nodir){var s=this.cache[i];if("DIR"===s||Array.isArray(s))return}this.matches[t][r]=!0,this.stat&&this._stat(r)}}},r.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var r,s;try{s=i.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var e=s&&s.isSymbolicLink();return this.symlinks[t]=e,e||!s||s.isDirectory()?r=this._readdir(t,!1):this.cache[t]="FILE",r},r.prototype._readdir=function(t,r){if(r&&!l(this.symlinks,t))return this._readdirInGlobStar(t);if(l(this.cache,t)){var s=this.cache[t];if(!s||"FILE"===s)return null;if(Array.isArray(s))return s}try{return this._readdirEntries(t,i.readdirSync(t))}catch(r){return this._readdirError(t,r),null}},r.prototype._readdirEntries=function(t,r){if(!this.mark&&!this.stat)for(var i=0;i<r.length;i++){var s=r[i];s="/"===t?t+s:t+"/"+s,this.cache[s]=!0}return this.cache[t]=r,r},r.prototype._readdirError=function(t,r){switch(r.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(t);if(this.cache[i]="FILE",i===this.cwdAbs){var s=new Error(r.code+" invalid cwd "+this.cwd);throw s.path=this.cwd,s.code=r.code,s}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw r;this.silent||console.error("glob error",r)}},r.prototype._processGlobStar=function(t,r,i,s,e,a){var h=this._readdir(i,a);if(h){var c=s.slice(1),o=t?[t]:[],n=o.concat(c);this._process(n,e,!1);var l=h.length;if(!this.symlinks[i]||!a)for(var f=0;f<l;f++)if("."!==h[f].charAt(0)||this.dot){var u=o.concat(h[f],c);this._process(u,e,!0);var p=o.concat(h[f],s);this._process(p,e,!0)}}},r.prototype._processSimple=function(t,r){var i=this._stat(t);if(this.matches[r]||(this.matches[r]=Object.create(null)),i){if(t&&c(t)&&!this.nomount){var s=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=a.join(this.root,t):(t=a.resolve(this.root,t),s&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(r,t)}},r.prototype._stat=function(t){var r=this._makeAbs(t),s="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&l(this.cache,r)){if(h=this.cache[r],Array.isArray(h)&&(h="DIR"),!s||"DIR"===h)return h;if(s&&"FILE"===h)return!1}var e=this.statCache[r];if(!e){var a;try{a=i.lstatSync(r)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[r]=!1,!1}if(a&&a.isSymbolicLink())try{e=i.statSync(r)}catch(t){e=a}else e=a}this.statCache[r]=e;var h=!0;return e&&(h=e.isDirectory()?"DIR":"FILE"),this.cache[r]=this.cache[r]||h,(!s||"FILE"!==h)&&h},r.prototype._mark=function(t){return o.mark(this,t)},r.prototype._makeAbs=function(t){return o.makeAbs(this,t)};