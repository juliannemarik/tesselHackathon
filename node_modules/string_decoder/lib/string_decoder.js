"use strict";function t(t){this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(o.isEncoding===u||!u(t)))throw Error("Unknown encoding: "+t);return e||t}(t);var e;switch(this.encoding){case"utf16le":this.text=a,this.end=i,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=n,this.end=r,e=3;break;default:return this.write=h,void(this.end=l)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(e)}function e(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,s=function(t,e){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function a(t,e){var s,a;return(t.length-e)%2==0?(s=t.toString("utf16le",e))&&(a=s.charCodeAt(s.length-1))>=55296&&a<=56319?(this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)):s:(this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1))}function i(t){var e,s=t&&t.length?this.write(t):"";return this.lastNeed?(e=this.lastTotal-this.lastNeed,s+this.lastChar.toString("utf16le",0,e)):s}function n(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function r(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function l(t){return t&&t.length?this.write(t):""}var o=require("safe-buffer").Buffer,u=o.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};exports.StringDecoder=t,t.prototype.write=function(t){var e,s;if(0===t.length)return"";if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},t.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},t.prototype.text=function(t,s){var a,i=function(t,s,a){var i,n=s.length-1;return n<a?0:(i=e(s[n]))>=0?(i>0&&(t.lastNeed=i-1),i):--n<a||-2===i?0:(i=e(s[n]))>=0?(i>0&&(t.lastNeed=i-2),i):--n<a||-2===i?0:(i=e(s[n]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,s);return this.lastNeed?(this.lastTotal=i,a=t.length-(i-this.lastNeed),t.copy(this.lastChar,0,a),t.toString("utf8",s,a)):t.toString("utf8",s)},t.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};