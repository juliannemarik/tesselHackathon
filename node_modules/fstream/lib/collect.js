function e(n){function t(e){"string"==typeof e&&(e=new Buffer(e)),Buffer.isBuffer(e)&&!e.length||o.push(e)}function r(n){e(n),i.push(n)}var o,i;n._collected||(n._collected=!0,n.pause(),n.on("data",t),n.on("end",t),o=[],n.on("entry",r),i=[],n.on("proxy",function(e){e.pause()}),n.pipe=function(e){return function(u){var f=0;return function p(){var a=i[f++];if(!a)return n.removeListener("entry",r),n.removeListener("data",t),n.removeListener("end",t),n.pipe=e,u&&n.pipe(u),o.forEach(function(e){e?n.emit("data",e):n.emit("end")}),void n.resume();a.on("end",p),u?u.add(a):n.emit("entry",a)}(),u}}(n.pipe))}module.exports=e;