function e(t){if(!(this instanceof e))throw Error("FileWriter must be called as constructor.");if("File"!==t.type||!t.File)throw Error("Non-file type "+t.type);this._buffer=[],this._bytesWritten=0,r.call(this,t)}module.exports=e;var t=require("graceful-fs"),r=(require("mkdirp"),require("./writer.js")),i={};require("inherits")(e,r),e.prototype._create=function(){var e,s=this;s._stream||(e={},s.props.flags&&(e.flags=s.props.flags),e.mode=r.filemode,s._old&&s._old.blksize&&(e.bufferSize=s._old.blksize),s._stream=t.createWriteStream(s._path,e),s._stream.on("open",function(){s.ready=!0,s._buffer.forEach(function(e){e===i?s._stream.end():s._stream.write(e)}),s.emit("ready"),s.emit("drain")}),s._stream.on("drain",function(){s.emit("drain")}),s._stream.on("close",function(){s._finish()}))},e.prototype.write=function(e){var t,r=this;if(r._bytesWritten+=e.length,!r.ready){if(!Buffer.isBuffer(e)&&"string"!=typeof e)throw Error("invalid write data");return r._buffer.push(e),!1}return!1===(t=r._stream.write(e))&&r._stream._queue?r._stream._queue.length<=2:t},e.prototype.end=function(e){return e&&this.write(e),this.ready?this._stream.end():(this._buffer.push(i),!1)},e.prototype._finish=function(){"number"==typeof this.size&&this._bytesWritten!=this.size&&this.error("Did not get expected byte count.\nexpect: "+this.size+"\nactual: "+this._bytesWritten),r.prototype._finish.call(this)};