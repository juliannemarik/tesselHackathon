function n(n){return n?function(c,t,e,r){return n.call(i,c,t,e,function(n,c){o(n)&&(n=null),r(n,c)})}:n}function c(n){return n?function(c,t,e){try{return n.call(i,c,t,e)}catch(n){if(!o(n))throw n}}:n}function o(n){return!n||"ENOSYS"===n.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==n.code&&"EPERM"!==n.code)}var t,e,r,u,i=require("./fs.js"),f=require("constants"),h=process.cwd,s=null;process.cwd=function(){return s||(s=h.call(process)),s},t=process.chdir,process.chdir=function(n){s=null,t.call(process,n)},f.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&(i.lchmod=function(n,c,o){o=o||noop,i.open(n,f.O_WRONLY|f.O_SYMLINK,c,function(n,t){n?o(n):i.fchmod(t,c,function(n){i.close(t,function(c){o(n||c)})})})},i.lchmodSync=function(n,c){var o,t,e,r=i.openSync(n,f.O_WRONLY|f.O_SYMLINK,c);try{e=i.fchmodSync(r,c)}catch(n){o=n}try{i.closeSync(r)}catch(n){t=n}if(o||t)throw o||t;return e}),i.lutimes||(f.hasOwnProperty("O_SYMLINK")?(i.lutimes=function(n,c,o,t){i.open(n,f.O_SYMLINK,function(n,e){if(t=t||noop,n)return t(n);i.futimes(e,c,o,function(n){i.close(e,function(c){return t(n||c)})})})},i.lutimesSync=function(n,c,o){var t,e,r,u=i.openSync(n,f.O_SYMLINK);try{r=i.futimesSync(u,c,o)}catch(n){t=n}try{i.closeSync(u)}catch(n){e=n}if(t||e)throw t||e;return r}):i.utimensat&&f.hasOwnProperty("AT_SYMLINK_NOFOLLOW")?(i.lutimes=function(n,c,o,t){i.utimensat(n,c,o,f.AT_SYMLINK_NOFOLLOW,t)},i.lutimesSync=function(n,c,o){return i.utimensatSync(n,c,o,f.AT_SYMLINK_NOFOLLOW)}):(i.lutimes=function(n,c,o,t){process.nextTick(t)},i.lutimesSync=function(){})),i.chown=n(i.chown),i.fchown=n(i.fchown),i.lchown=n(i.lchown),i.chmod=n(i.chmod),i.fchmod=n(i.fchmod),i.lchmod=n(i.lchmod),i.chownSync=c(i.chownSync),i.fchownSync=c(i.fchownSync),i.lchownSync=c(i.lchownSync),i.chmodSync=n(i.chmodSync),i.fchmodSync=n(i.fchmodSync),i.lchmodSync=n(i.lchmodSync),i.lchmod||(i.lchmod=function(n,c,o){process.nextTick(o)},i.lchmodSync=function(){}),i.lchown||(i.lchown=function(n,c,o,t){process.nextTick(t)},i.lchownSync=function(){}),"win32"===process.platform&&(e=i.rename,i.rename=function(n,c,o){var t=Date.now();e(n,c,function r(u){if(u&&("EACCES"===u.code||"EPERM"===u.code)&&Date.now()-t<1e3)return e(n,c,r);o&&o(u)})}),r=i.read,i.read=function(n,c,o,t,e,u){var f,h;return u&&"function"==typeof u&&(h=0,f=function(s){if(s&&"EAGAIN"===s.code&&h<10)return h++,r.call(i,n,c,o,t,e,f);u.apply(this,arguments)}),r.call(i,n,c,o,t,e,f)},u=i.readSync,i.readSync=function(n,c,o,t,e){for(var r=0;;)try{return u.call(i,n,c,o,t,e)}catch(n){if("EAGAIN"===n.code&&r<10){r++;continue}throw n}};